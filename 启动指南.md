# 🚀 启动指南

## 问题总结

你之前遇到的启动问题主要有以下几个原因:

### 1. **配置文件层级错误** ⚠️
`application.yml` 中 mysql profile 的配置缩进不正确,导致虽然激活了 mysql profile,但实际仍使用 H2 数据库。

**已修复**: 调整了配置文件的层级结构。

### 2. **前后端端口不匹配** ⚠️
- 后端配置运行在 8081 端口
- 但前端登录/注册页面还在调用 8080 端口

**已修复**: 统一前端所有 API 调用使用 8081 端口。

### 3. **端口占用冲突** ⚠️
之前 8080 端口被其他进程占用,导致后端无法启动。

**已解决**: 现在后端使用 8081 端口,避免了冲突。

---

## 🎯 快速启动

### 方式一: 一键启动 (推荐)
在项目根目录右键选择 "用 PowerShell 运行":
```powershell
.\start-all.ps1
```
这会自动在两个新窗口中启动前后端服务。

### 方式二: 分别启动
```powershell
# 启动后端 (在一个终端)
.\start-backend.ps1

# 启动前端 (在另一个终端)
.\start-frontend.ps1
```

### 方式三: 手动启动
```powershell
# 后端 (使用 H2 内存数据库)
cd backend
.\mvnw.cmd spring-boot:run

# 后端 (使用 MySQL 数据库)
cd backend
.\mvnw.cmd spring-boot:run "-Dspring-boot.run.profiles=mysql"

# 前端
cd frontend
npm run dev
```

---

## 📌 服务地址

| 服务 | 地址 | 说明 |
|------|------|------|
| 前端 | http://localhost:5173 | Vite 开发服务器 |
| 后端 | http://localhost:8081 | Spring Boot API |
| H2 控制台 | http://localhost:8081/h2-console | 数据库管理 (仅 H2 模式) |

---

## 🗄️ 数据库选择

### 使用 H2 内存数据库 (默认,推荐开发使用)
**优点**:
- ✅ 无需安装配置
- ✅ 启动快速
- ✅ 数据隔离,每次启动都是干净状态

**缺点**:
- ❌ 重启后数据丢失

**启动命令**:
```powershell
.\mvnw.cmd spring-boot:run
```

### 使用 MySQL 数据库 (可选)
**前提条件**:
1. 确保 MySQL 服务运行在 3306 端口
2. 创建数据库: `CREATE DATABASE weishuo;`
3. 设置密码环境变量或使用默认密码 `111111`

**启动命令**:
```powershell
.\mvnw.cmd spring-boot:run "-Dspring-boot.run.profiles=mysql"
```

---

## 🔧 常见问题排查

### 1. 端口被占用
```powershell
# 查看端口占用
netstat -ano | findstr :8081
netstat -ano | findstr :5173

# 终止进程 (替换 <PID> 为实际进程ID)
Stop-Process -Id <PID> -Force
```

### 2. 后端启动失败
- 检查 Java 版本: `java -version` (需要 JDK 17+)
- 检查 Maven: `.\mvnw.cmd -v`
- 查看完整错误日志

### 3. 前端启动失败
- 检查 Node.js: `node -v` (需要 Node.js 16+)
- 重新安装依赖: `cd frontend && npm install`

### 4. API 调用失败
- 确认后端已启动: http://localhost:8081/actuator/health
- 检查浏览器控制台的网络请求
- 确认前端 API 地址配置正确 (应为 8081)

---

## 📝 开发提示

1. **数据持久化**: 默认使用 H2 内存数据库,重启后数据会丢失。如需持久化,切换到 MySQL。

2. **热重载**: 
   - 前端支持热重载,修改代码会自动刷新
   - 后端需要重启才能看到更改

3. **API 测试**: 可以使用 Postman 或浏览器访问:
   - GET http://localhost:8081/api/news
   - POST http://localhost:8081/api/auth/register

4. **日志查看**: 后端日志会直接输出在终端窗口中

---

## 🎉 现在就开始

打开浏览器访问: **http://localhost:5173**

祝你开发愉快! 🚀
